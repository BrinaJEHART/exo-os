<div id="weather-box-window" class="box-window">
    <div class="box-window-top">
        <div class="box-window-top-draggable">
            <h3>eXo-weather</h3>
        </div>
        <span class="exit">&times;</span>
        <span class="box-window-toggle-fullScreen">&#9634;</span>
    </div>
    <div>
        <input id="locationInput" type="text" placeholder="enter location" value="" />
    </div>
    <div class="box-window-content">
        <div id="weatherData">
        </div>
    </div>
    <script>
        $(document).ready(() => {

            var weatherTypes = [
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'},
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'},
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'},
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'},
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'},
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'},
                {keyCode: "Sunny", imgPath: './imgs/suuny.png'}
            ];
            
            const getWeatherData = location => {
                try {
                    $("#locationList").html("");
                    weather.find({ search: String(location), degreeType: 'C' }, (err, result) => {
                        if (!result.length || err) return;

                        $("#weatherData").append(`
                            <span>Today</span><hr>
                            <div id="today_weather"></div>
                            <span>Forecast</span><hr>
                            <table style="
                                position: relative; 
                                width: 100%; 
                                margin-left: 0;
                                margin-top: 0;
                                border-collapse: collapse;
                            ">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>$Lowest temp</th>
                                        <th>Highest temp</th>
                                        <th>Weather</th>    
                                    </tr>    
                                </thead>
                                <tbody id="forecast_weather">

                                </tbody>
                            </table>
                            <style>
                                thead {
                                    backgorund-color: blue;
                                }
                                tr {
                                    margin-bottom: 15px;
                                    border-bottom: 1px solid black;
                                }
                            </style>
                        `);

                        //globalWeatherData = result;
                        $("#today_weather").html(`
                            <div>Temp: ${result[0].current.temperature}°C</div>
                            <div>Weather: ${result[0].current.skytext}</div>
                            <div>Wind speed: ${result[0].current.windspeed}</div>
                            <img src="http://blob.weather.microsoft.com/static/weather4/en-us/law/${result[0].current.skycode}.gif" alt="/" />
                        `);

                        result[0].forecast.forEach(day => $(`#forecast_weather`).append(`
                            <tr>
                                <td>${day.date}</td>
                                <td>${day.low}</td>
                                <td>${day.high}</td>
                                <td>${day.skytextday}</td>
                            </tr>
                        `));

                        /*for (let i = 0; i < result.length; i++) {
                            $("#locationList").append(`
                                <li>
                                    <span class="locSpan" id="${i}_place">
                                        ${result[i].location.name}
                                    </span>
                                </li>
                            `);

                            /*$("#actualLocationData").append(`
                                <div id="${i}locDiv">   
                                        <div>Temp: ${result[i].current.temperature}°C</div>
                                        <div>Weather: ${result[i].current.skytext}</div>
                                        <div>Wind speed: ${result[i].current.windspeed}</div>
                                        <label for="${i}forecast">Forecast</label>
                                        <div id="${i}forecast"></div>                
                                </div>
                            `);


                            result[0].forecast.forEach(day => $(`#${i}forecast`).append(`
                                <div>Date: ${day.date}<div><br>
                                <div>Lowest temp: ${day.low}<div><br>
                                <div>Highest temp: ${day.high}<div><br> 
                                <div>Weather: ${day.skytextday}<div><br>
                            `));

                        }*/
                            
                    });
                } catch (err) {
                    ipcRenderer.send('request-failed-to-generate-action');
                }
            }

            $(document).on('keypress', "#locationInput", event => {
                if(event.keyCode == 13){
                    $("#weatherData").html('');
                    getWeatherData($("#locationInput").val());
                } 
            });
        });
    </script>
</div>